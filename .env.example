# ==================================================
# FastAPI Best Architecture - Rust 环境变量配置
# ==================================================
# 
# 使用说明:
# 1. 复制此文件为 .env
#    PowerShell: Copy-Item .env.example .env
#    Linux/Mac: cp .env.example .env
# 2. 根据实际情况修改配置项
# 3. 确保 .env 文件已添加到 .gitignore（已配置）
# 4. 生产环境必须修改所有密钥和密码
#
# 注意事项:
# - 字符串值: 可以不加引号或使用单引号
# - 布尔值: true/false (不加引号)
# - 数字值: 直接写数字 (不加引号)
# - 数组和对象: 使用 JSON 格式并用单引号包裹
# - 所有配置项都支持 FBA_ 前缀（如 FBA_DEBUG_MODE）
# ==================================================

# ==================================================
# 运行环境配置
# ==================================================
# 可选值: dev, prod, production
# dev: 开发环境，启用详细日志和调试功能
# prod/production: 生产环境，优化性能和安全性
ENVIRONMENT=dev

# ==================================================
# 数据库配置 (支持 mysql, postgresql, sqLite)
# ==================================================

# 数据库类型 (必填)
# 可选值: MySQL, PostgreSQL, SQLite, mysql, postgresql, sqlite
DATABASE_TYPE=mysql

# === SQLite 配置示例 (默认) ===
# 适合: 开发环境、小型项目、快速原型
# DATABASE_TYPE='sqLite'
# DATABASE_NAME='./fba.db'  # 数据库文件路径
# 初始化: sqlite3 fba.db < sql/sqlite/init_test_data.sql

# === PostgreSQL 配置示例 ===
# 适合: 生产环境、大型项目、高并发场景
# DATABASE_TYPE='PostgreSQL'
DATABASE_HOST='127.0.0.1'
DATABASE_PORT=3306
DATABASE_USER='root'
DATABASE_PASSWORD='123456'
# DATABASE_NAME='fba'  # PostgreSQL 数据库名
DATABASE_SCHEMA='public'
# 初始化: psql -U postgres -d fba -f sql/postgresql/init_test_data.sql

# === MySQL 配置示例 ===
# 适合: 传统项目、成熟生态、广泛支持
# DATABASE_TYPE='mysql'
# DATABASE_HOST='127.0.0.1'
# DATABASE_PORT=3306
# DATABASE_USER='root'
# DATABASE_PASSWORD='your_password'
# DATABASE_NAME='fba'  # MySQL 数据库名
# DATABASE_CHARSET='utf8mb4'
# 初始化: mysql -u root -p fba < sql/mysql/init_test_data.sql

# 数据库名称/路径 (根据DATABASE_TYPE自动解释)
DATABASE_NAME=fba

# 字符集 (仅 MySQL 使用)
DATABASE_CHARSET=utf8mb4

# 连接池配置
DATABASE_POOL_SIZE=10          # 连接池大小 (建议: dev=10, prod=20)
DATABASE_TIMEOUT=30             # 连接超时时间(秒)

# 调试配置
DATABASE_ECHO=true             # 是否打印 SQL 语句 (开发时可设为true)
DATABASE_POOL_ECHO=true        # 是否打印连接池信息

# ==================================================
# Redis 配置
# ==================================================
# Redis 服务器地址
REDIS_HOST=127.0.0.1
REDIS_PORT=6379

# Redis 密码 (留空表示无密码，生产环境必须设置)
REDIS_PASSWORD=

# Redis 数据库编号 (0-15，默认0)
REDIS_DATABASE=0

# 连接配置
REDIS_TIMEOUT=5                 # 连接超时时间(秒)
REDIS_POOL_SIZE=10              # 连接池大小

# ==================================================
# JWT Token 配置
# ==================================================
# JWT 密钥 (必须修改！！！)
TOKEN_SECRET_KEY=1VkVF75nsNABBjK_7-qz7GtzNy3AMvktc9TCPwKczCk

# JWT 算法 (推荐 HS256)
TOKEN_ALGORITHM=HS256

# Token 过期时间 (秒)
TOKEN_EXPIRE_SECONDS=86400              # Access Token: 1天 (24小时)
TOKEN_REFRESH_EXPIRE_SECONDS=604800     # Refresh Token: 7天

# Redis 缓存前缀 (避免键名冲突)
TOKEN_REDIS_PREFIX=fba:token
TOKEN_EXTRA_INFO_REDIS_PREFIX=fba:token_extra_info
TOKEN_ONLINE_REDIS_PREFIX=fba:token_online
TOKEN_REFRESH_REDIS_PREFIX=fba:refresh_token
JWT_USER_REDIS_PREFIX=fba:user

# ==================================================
# FastAPI / Web 服务配置
# ==================================================
# API 路由前缀
FASTAPI_API_V1_PATH=/api/v1

# API 文档配置
FASTAPI_TITLE=FastAPI Best Architecture - Rust
FASTAPI_DESCRIPTION=高性能 Rust Web 后端框架

# API 文档访问路径
FASTAPI_DOCS_URL=/docs          # Swagger UI 文档
FASTAPI_REDOC_URL=/redoc        # ReDoc 文档
FASTAPI_OPENAPI_URL=/openapi    # OpenAPI JSON

# 静态文件服务
FASTAPI_STATIC_FILES=true         # 是否启用静态文件服务

# ==================================================
# Cookie 配置
# ==================================================
COOKIE_REFRESH_TOKEN_KEY=fba_refresh_token
COOKIE_REFRESH_TOKEN_EXPIRE_SECONDS=604800

# ==================================================
# 验证码配置
# ==================================================
CAPTCHA_LOGIN_REDIS_PREFIX=fba:login:captcha
CAPTCHA_LOGIN_EXPIRE_SECONDS=300

# ==================================================
# RBAC 权限配置
# ==================================================
RBAC_ROLE_MENU_MODE=true
RBAC_ROLE_MENU_EXCLUDE='["sys:monitor:redis","sys:monitor:server"]'

# ==================================================
# 数据权限配置
# ==================================================
DATA_PERMISSION_MODELS='{"dept": "fastapi_best_architecture_rust::database::dept"}'
DATA_PERMISSION_COLUMN_EXCLUDE='["id","sort","del_flag","created_time","updated_time"]'

# ==================================================
# CORS 跨域配置
# ==================================================
# 是否启用 CORS 中间件
MIDDLEWARE_CORS=true

# 允许的源地址 (前端地址)
CORS_ALLOWED_ORIGINS='["http://127.0.0.1:8000","http://localhost:5173","http://localhost:3000"]'

# 暴露的响应头
CORS_EXPOSE_HEADERS='["X-Request-ID"]'

# ==================================================
# 限流配置
# ==================================================
REQUEST_LIMITER_REDIS_PREFIX=fba:limiter

# ==================================================
# 时间配置
# ==================================================
DATETIME_TIMEZONE=Asia/Shanghai
DATETIME_FORMAT=%Y-%m-%d %H:%M:%S

# ==================================================
# 文件上传配置
# ==================================================
UPLOAD_READ_SIZE=1024
UPLOAD_IMAGE_EXT_INCLUDE='["jpg","jpeg","png","gif","webp"]'
UPLOAD_IMAGE_SIZE_MAX=5242880           # 5MB
UPLOAD_VIDEO_EXT_INCLUDE='["mp4","mov","avi","flv"]'
UPLOAD_VIDEO_SIZE_MAX=20971520          # 20MB

# ==================================================
# 演示模式配置
# ==================================================
DEMO_MODE=false
DEMO_MODE_EXCLUDE='[("POST","/api/v1/auth/login"),("POST","/api/v1/auth/logout"),("GET","/api/v1/auth/captcha"),("POST","/api/v1/auth/refresh")]'

# ==================================================
# IP 定位配置
# ==================================================
IP_LOCATION_PARSE=offline
IP_LOCATION_REDIS_PREFIX=fba:ip:location
IP_LOCATION_EXPIRE_SECONDS=86400

# ==================================================
# Trace ID 配置
# ==================================================
TRACE_ID_REQUEST_HEADER_KEY=X-Request-ID
TRACE_ID_LOG_LENGTH=32
TRACE_ID_LOG_DEFAULT_VALUE=-

# ==================================================
# 日志配置
# ==================================================

# 调试模式：显示详细日志（URL/IP/耗时/SQL等）开发=true 生产=false
DEBUG_MODE=false

# JSON日志（用于日志收集系统）
LOG_JSON=false

# 日志文件路径（留空=仅控制台）
# LOG_FILE=./logs/fba.log

# 日志级别（DEBUG_MODE=true时自动为DEBUG）
LOG_STD_LEVEL=INFO

# ==================================================
# 操作日志配置
# ==================================================
# 加密密钥 (必须修改！！！)

OPERA_LOG_ENCRYPT_SECRET_KEY=d77b25790a804c2b4a339dd0207941e4cefa5751935a33735bc73bb7071a005b

# 排除路径 (不记录操作日志的路径)
OPERA_LOG_PATH_EXCLUDE='["/favicon.ico","/docs","/redoc","/openapi","/api/v1/auth/login/swagger","/api/v1/oauth2/github/callback","/api/v1/oauth2/google/callback","/api/v1/oauth2/linux-do/callback"]'

# 加密配置
OPERA_LOG_ENCRYPT_TYPE=1            # 加密类型: 0=不加密, 1=AES加密
OPERA_LOG_ENCRYPT_KEY_INCLUDE='["password","old_password","new_password","confirm_password"]'

# ==================================================
# Plugin 插件配置
# ==================================================
PLUGIN_REDIS_PREFIX=fba:plugin

# ==================================================
# I18n 国际化配置
# ==================================================
I18N_DEFAULT_LANGUAGE=zh-CN

# ==================================================
# [Plugin] code_generator 代码生成器配置
# ==================================================
CODE_GENERATOR_DOWNLOAD_ZIP_FILENAME=fba_generator
